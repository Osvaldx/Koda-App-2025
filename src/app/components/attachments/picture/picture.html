<div class="flex flex-col items-center">
  <form [formGroup]="myForm" class="w-full max-w-xs">
    @if (!imageSrc) {
      <div class="space-y-2">
        @if (!hideText) {
          <label for="file" class="block text-sm font-medium text-gray-700 text-center mb-2">
            Seleccionar imagen
          </label>
        }
        <label
          for="file"
          class="w-32 h-32 rounded-full flex flex-col items-center justify-center bg-white text-gray-600 border-2 border-dashed border-gray-300 cursor-pointer hover:bg-gray-50 transition-colors mx-auto"
        >
          <svg
            class="w-10 h-10 mb-1 text-gray-400"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
            ></path>
          </svg>
          <span class="text-xs text-gray-500 text-center px-2">
            Subir imagen
          </span>
          <input
            formControlName="file"
            id="file"
            type="file"
            class="hidden"
            accept="image/*"
            (change)="onFileChange($event)"
          />
        </label>
        @if (f['file'].touched && f['file'].invalid) {
          <div class="text-sm text-red-600 text-center">
            @if (f['file'].errors && f['file'].errors['required']) {
              <p>Debes seleccionar una imagen</p>
            }
          </div>
        }
      </div>
    } @else {
      <div class="relative group">
        <div class="w-32 h-32 rounded-full overflow-hidden border-2 border-gray-200 mx-auto">
          <img
            [src]="imageSrc"
            alt="Vista previa de la imagen"
            class="w-full h-full object-cover"
          />
        </div>
        <button
          type="button"
          (click)="removeImage()"
          class="absolute -top-2 -right-2 bg-white rounded-full p-1 shadow-md hover:bg-red-50 transition-colors"
          title="Eliminar imagen"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5 text-red-500"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            />
          </svg>
        </button>
      </div>
    }
  </form>
</div>
